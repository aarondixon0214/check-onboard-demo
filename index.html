<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Employer Dashboard</title>
  <style>
    body { font-family: Arial, sans-serif; margin: 0; padding: 0; }
    .nav { background: #333; color: white; padding: 1rem; }
    .nav select { font-size: 1rem; margin-left: 1rem; }
    .container { padding: 1rem; }
    #onboard-frame { width: 100%; height: 600px; border: none; display: none; }
  </style>
</head>
<body>
  <div class="nav">
    <label for="payroll-dropdown">Payroll:</label>
    <select id="payroll-dropdown">
      <option value="">-- Select --</option>
      <option value="onboard">Onboard</option>
      <option value="view">View</option>
    </select>
  </div>

  <div class="container">
    <iframe id="onboard-frame"></iframe>
  </div>

  <script>
    document.getElementById('payroll-dropdown').addEventListener('change', async function (event) {
      const selected = event.target.value;
      const iframe = document.getElementById('onboard-frame');

      if (selected === 'onboard') {
        try {
          const response = await fetch('/api/onboard-link', {
            method: 'POST',
            headers: {
              'Content-Type': 'application/json'
            },
            body: JSON.stringify({
              company_id: 'your-company-id',
              partner_user_id: 'admin-user-id'
            })
          });

          const data = await response.json();
          if (data.url) {
            iframe.src = data.url;
            iframe.style.display = 'block';
          } else {
            alert('Failed to get onboarding URL');
          }
        } catch (error) {
          console.error('Error fetching onboarding link:', error);
          alert('Error generating onboarding link');
        }
      } else {
        iframe.style.display = 'none';
        iframe.src = '';
      }
    });
  </script>
</body>
</html>
